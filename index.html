<!DOCTYPE html>
<html>
    <body>
        <style>
            #holder {
                border: 10px dashed #ccc;
                width: 300px;
                height: 300px;
                margin: 20px auto;
            }
            
            #holder.hover {
                border: 10px dashed #333;
            }
        </style>
        
        <div id="holder"></div>
        
        <div id="dialog" >
          Choose a path to save your shot:
          <input type="file" nwsaveas="filename.txt" />
        </div>
        
        <script>
            var getConfig = require( './js/getconfig.js' ),
                getImages = require( './js/getimages.js' ),
                doZip = require( './js/dozip.js' );
                
        
            window.ondragover = function( evt ){
                evt.preventDefault();
                return false;
            };
            
            window.ondrop = function( evt ){
                evt.preventDefault();
                return false;
            };
            
            var holder = document.getElementById( 'holder' );
            
            holder.ondragover = function(){
                this.className = 'hover';
                return false;
            };
            
            holder.ondragleave = function(){
                this.className = '';
                return false;
            };
            
            holder.ondrop = function( evt ){
                evt.preventDefault();
                
                for ( var i = 0; i < evt.dataTransfer.files.length; ++i ){
                    var _path = evt.dataTransfer.files[ i ].path;
                    
                    getConfig( _path )
                        .then( function( configAr ){
                            return Promise.all( configAr.map( getImages ) );
                        })                        
                        .then( function( imagesAr ){
                            return doZip( imagesAr )                 
                        })
                        .then(function( zip ){
                            // @TODO write save function
                            save( zip );
                        })                    
                    
                }
                
                return false;
            };
            
        </script>
    </body>
</html>
            
            
            
            
            
            
            
            
            
            
            
            
